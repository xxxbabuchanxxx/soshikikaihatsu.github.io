# SSAP提案システム - ファイル構成

## 📁 ディレクトリ構造

```
ssap_proposal_system/
│
├── index.html                 # ホームページ（ランディングページ）
├── submit.html                # 提案投稿フォーム
├── proposals.html             # 提案一覧・投票ページ
│
├── css/
│   └── style.css              # 全ページ共通スタイルシート
│
├── js/
│   ├── config.js              # 設定ファイル（GAS URL、従業員数など）
│   ├── api.js                 # API通信モジュール
│   ├── submit.js              # 投稿ページのロジック
│   └── proposals.js           # 一覧ページのロジック
│
├── backend/
│   └── gas_backend.gs         # Google Apps Scriptバックエンドコード
│
├── README.md                  # プロジェクト全体の詳細ドキュメント
├── SETUP_GUIDE.md             # セットアップクイックガイド
├── DEPLOY_CHECKLIST.md        # デプロイ前チェックリスト
├── LICENSE                    # MITライセンス
└── .gitignore                 # Git除外設定
```

## 📄 各ファイルの説明

### HTMLファイル

#### `index.html`
- **役割**: システムのホームページ
- **機能**:
  - システム概要の説明
  - 使い方ガイド
  - 統計情報の表示（掲載中の提案数、実施候補数）
  - 投稿ページ・一覧ページへのナビゲーション

#### `submit.html`
- **役割**: 提案投稿フォーム
- **機能**:
  - タイトル、カテゴリ、説明の入力
  - 提案者情報の入力（名前、メール）
  - フォームバリデーション
  - 文字数カウント（説明欄）
  - 投稿完了メッセージ
  - ローディング表示

#### `proposals.html`
- **役割**: 提案一覧・投票ページ
- **機能**:
  - 全提案のカード形式表示
  - いいね投票機能
  - カテゴリ・ステータスフィルター
  - キーワード検索
  - ソート機能（新しい順、いいね数順など）
  - 提案詳細モーダル表示
  - リアルタイム自動更新（30秒ごと）

### CSSファイル

#### `css/style.css`
- **役割**: 全ページ共通のスタイル定義
- **特徴**:
  - モダンなグラデーションデザイン
  - レスポンシブ対応（PC、タブレット、スマホ）
  - CSS変数でカラーテーマ管理
  - アニメーション効果
  - カード型レイアウト

### JavaScriptファイル

#### `js/config.js`
- **役割**: システム全体の設定管理
- **設定項目**:
  - GAS WebアプリURL
  - 全従業員数
  - 提案掲載期間
  - 自動更新間隔
  - ローカルストレージキー
- **ユーティリティ関数**:
  - ユーザー情報の保存/取得
  - いいね済み提案の管理

#### `js/api.js`
- **役割**: GASバックエンドとの通信
- **関数**:
  - `sendRequest()` - POST リクエスト送信
  - `getRequest()` - GET リクエスト送信
  - `addProposal()` - 提案投稿
  - `getProposals()` - 提案一覧取得
  - `addLike()` - いいね追加
  - `removeLike()` - いいね削除
  - エラーハンドリング

#### `js/submit.js`
- **役割**: 投稿ページの制御
- **機能**:
  - フォーム送信処理
  - バリデーション
  - 文字数カウント
  - ユーザー情報の自動入力
  - ローディング表示制御
  - 成功メッセージ表示

#### `js/proposals.js`
- **役割**: 一覧ページの制御
- **機能**:
  - 提案データの取得・表示
  - フィルター・検索・ソート
  - いいねトグル処理
  - モーダル表示制御
  - 自動更新（30秒ごと）
  - HTMLエスケープ処理

### バックエンド

#### `backend/gas_backend.gs`
- **役割**: Google Apps Scriptバックエンド
- **主要関数**:
  - `doPost()` - POST リクエストハンドラ
  - `doGet()` - GET リクエストハンドラ
  - `addProposal()` - 提案追加
  - `getProposals()` - 提案取得（期限切れ除外）
  - `addLike()` - いいね追加（重複チェック）
  - `removeLike()` - いいね削除
  - `cleanExpiredProposals()` - 期限切れ提案削除
  - `setupTriggers()` - 自動実行トリガー設定
- **データ管理**:
  - Googleスプレッドシートへの読み書き
  - 自動期限チェック
  - 実施候補への自動昇格（600票以上）

### ドキュメント

#### `README.md`
- **内容**:
  - プロジェクト概要
  - 機能一覧
  - システム構成
  - 詳細セットアップ手順
  - カスタマイズ方法
  - トラブルシューティング
  - データ構造
  - セキュリティ考慮事項

#### `SETUP_GUIDE.md`
- **内容**:
  - 5ステップクイックガイド
  - 画像付き手順（想定）
  - よくある問題と解決方法
  - 動作確認方法
  - 設定のカスタマイズ

#### `DEPLOY_CHECKLIST.md`
- **内容**:
  - デプロイ前の必須設定チェックリスト
  - 動作テスト項目
  - セキュリティチェック
  - デプロイ手順
  - リリース告知文例
  - メンテナンス計画

#### `LICENSE`
- MITライセンス

#### `.gitignore`
- Git管理から除外するファイル設定

## 🔄 データフロー

```
┌─────────────┐
│   ユーザー   │
└──────┬──────┘
       │
       │ 操作（投稿、いいね）
       ↓
┌─────────────────┐
│  フロントエンド   │
│  (GitHub Pages) │
│  - HTML/CSS/JS  │
└────────┬────────┘
         │
         │ HTTPS リクエスト
         ↓
┌────────────────────┐
│ Google Apps Script │
│   (Webアプリ)       │
│  - gas_backend.gs  │
└────────┬───────────┘
         │
         │ スプレッドシート操作
         ↓
┌───────────────────────┐
│ Google Spreadsheets   │
│  (データベース)        │
│  - 提案一覧シート      │
└───────────────────────┘
```

## 🎨 デザインシステム

### カラーパレット

- **Primary**: `#3182ce` (青) - メインカラー
- **Success**: `#48bb78` (緑) - 実施候補
- **Danger**: `#e53e3e` (赤) - いいね、削除
- **Warning**: `#ed8936` (オレンジ) - 期限間近
- **Secondary**: `#718096` (グレー) - サブボタン

### コンポーネント

- **カード**: 影付き、角丸、ホバー効果
- **ボタン**: 角丸、グラデーション、トランジション
- **バッジ**: 角丸、カテゴリ・ステータス表示
- **プログレスバー**: グラデーション、アニメーション
- **モーダル**: オーバーレイ、スライドイン

### レスポンシブブレークポイント

- **PC**: 769px以上
- **タブレット/スマホ**: 768px以下

## 🔐 セキュリティ

### データ保護

- メールアドレス: スプレッドシートに保存、フロントエンド非表示
- 投票記録: ローカルストレージ + サーバーサイド検証
- API: GAS経由でのみアクセス可能

### アクセス制御

- GAS: 「全員」に設定（認証不要）
- スプレッドシート: GASの実行アカウントのみアクセス可能

### 今後の改善案

1. Google OAuth認証
2. 社内ドメイン制限
3. reCAPTCHA導入
4. 管理者ダッシュボード

## 📊 Spreadsheetデータ構造

| 列 | 項目 | データ型 | 説明 |
|---|---|---|---|
| A | 提案ID | String | `SSAP_[timestamp]_[random]` |
| B | タイトル | String | 最大100文字 |
| C | 説明 | String | 最大2000文字 |
| D | カテゴリ | String | 選択式 |
| E | 提案者名 | String | 最大50文字 |
| F | 提案者メール | String | Email形式 |
| G | 投稿日時 | ISO 8601 | `2026-01-14T12:00:00.000Z` |
| H | 期限日時 | ISO 8601 | 投稿日+30日 |
| I | いいね数 | Number | 0以上 |
| J | いいねユーザー | String | カンマ区切りのメール |
| K | ステータス | String | `掲載中`/`実施候補`/`期限切れ` |
| L | 更新日時 | ISO 8601 | 最終更新日時 |

## 🚀 パフォーマンス

### 最適化

- 自動更新: 30秒間隔（設定変更可能）
- データ取得: 必要時のみ
- ローカルキャッシュ: いいね状態をローカルストレージに保存
- CSSアニメーション: GPU加速

### スケーラビリティ

- Google Spreadsheets: 最大500万セル
- GAS: 1日6時間の実行時間制限
- 推奨: 提案数1000件以下

## 🔄 メンテナンス

### 定期作業

1. **毎日**: 自動で期限切れ削除（午前2時）
2. **週次**: 不適切投稿チェック
3. **月次**: スプレッドシートバックアップ
4. **四半期**: 利用状況分析

### バックアップ

```javascript
// Spreadsheetのバックアップ方法
1. Googleスプレッドシートを開く
2. 「ファイル」→「コピーを作成」
3. 名前: 「SSAP_backup_YYYYMMDD」
```

## 📈 今後の拡張案

1. **コメント機能**: 提案へのコメント
2. **画像添付**: 提案に画像を添付
3. **通知機能**: 実施候補昇格時にメール通知
4. **分析ダッシュボード**: カテゴリ別統計
5. **進捗管理**: 実施候補の進捗状況
6. **ランキング**: 月間人気提案
7. **タグ機能**: 提案へのタグ付け
8. **エクスポート**: PDFレポート出力

---

**作成日**: 2026年1月14日  
**バージョン**: 1.0.0  
**作成者**: 組織開発課
